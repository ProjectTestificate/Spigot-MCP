--- decompiled\net\minecraft\tileentity\TileEntityNote.java
+++ src\main\java\net\minecraft\tileentity\TileEntityNote.java
@@ -5,61 +5,60 @@
 import net.minecraft.nbt.NBTTagCompound;
 import net.minecraft.util.BlockPos;
 import net.minecraft.util.MathHelper;
 import net.minecraft.world.World;
 
-public class TileEntityNote extends TileEntity
-{
+import org.bukkit.craftbukkit.event.CraftEventFactory;
+import org.bukkit.event.block.NotePlayEvent;
+
+public class TileEntityNote extends TileEntity {
+
     public byte note;
     public boolean previousRedstoneState;
     private static final String __OBFID = "CL_00000362";
 
-    public void writeToNBT(NBTTagCompound compound)
-    {
+    public void writeToNBT(NBTTagCompound compound) {
         super.writeToNBT(compound);
         compound.setByte("note", this.note);
     }
 
-    public void readFromNBT(NBTTagCompound compound)
-    {
+    public void readFromNBT(NBTTagCompound compound) {
         super.readFromNBT(compound);
         this.note = compound.getByte("note");
-        this.note = (byte)MathHelper.clamp_int(this.note, 0, 24);
+        this.note = (byte) MathHelper.clamp_int(this.note, 0, 24);
     }
 
-    public void changePitch()
-    {
-        this.note = (byte)((this.note + 1) % 25);
+    public void changePitch() {
+        this.note = (byte) ((this.note + 1) % 25);
         this.markDirty();
     }
 
-    public void triggerNote(World worldIn, BlockPos p_175108_2_)
-    {
-        if (worldIn.getBlockState(p_175108_2_.up()).getBlock().getMaterial() == Material.air)
-        {
+    public void triggerNote(World worldIn, BlockPos p_175108_2_) {
+        if (worldIn.getBlockState(p_175108_2_.up()).getBlock().getMaterial() == Material.air) {
             Material material = worldIn.getBlockState(p_175108_2_.down()).getBlock().getMaterial();
             byte b0 = 0;
 
-            if (material == Material.rock)
-            {
+            if (material == Material.rock) {
                 b0 = 1;
             }
 
-            if (material == Material.sand)
-            {
+            if (material == Material.sand) {
                 b0 = 2;
             }
 
-            if (material == Material.glass)
-            {
+            if (material == Material.glass) {
                 b0 = 3;
             }
 
-            if (material == Material.wood)
-            {
+            if (material == Material.wood) {
                 b0 = 4;
             }
 
-            worldIn.addBlockEvent(p_175108_2_, Blocks.noteblock, b0, this.note);
+            // CraftBukkit start
+            NotePlayEvent event = CraftEventFactory.callNotePlayEvent(this.worldObj, p_175108_2_.getX(), p_175108_2_.getY(), p_175108_2_.getZ(), b0, this.note);
+            if (!event.isCancelled()) {
+                worldIn.addBlockEvent(p_175108_2_, Blocks.noteblock, event.getInstrument().getType(), event.getNote().getId());
+            }
+            // CraftBukkit end
         }
     }
 }
